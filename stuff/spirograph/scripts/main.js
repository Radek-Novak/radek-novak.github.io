function resetElem(a){var b=$(a),c=b.clone(!0);b.before(c),$("."+b.attr("class")+":last").remove()}function setupCanvas(){pauseAnim();var a=$(window),b=a.width(),c=a.height();$canvas.attr("width",b).attr("height",c),$(rods).height((c>b?b:c)/6-30),clearScreen(),playAnim()}function pauseAnim(){$(rods).css("animation-play-state","paused"),paused=!0,$(".pause").text("run")}function playAnim(){$(rods).css("animation-play-state","running"),paused=!1,$(".pause").text("pause")}function changeAnimTime(a,b){var c=animVals.join(" ");pauseAnim(),animVals[1]=b+"s",$("."+a).css({"-webkit-animation":c,animation:c}),resetElem("."+a),playAnim(),clearScreen()}function draw(a,b){ctx.strokeStyle=linecolor,ctx.beginPath(),ctx.moveTo(last.x,last.y),last.x&&ctx.lineTo(a,b),ctx.lineWidth=2,ctx.lineCap="round",ctx.stroke(),last={x:a,y:b}}function clearScreen(){ctx.clearRect(0,0,9999,9999)}function render(){var a;paused||(a=$(".draw").offset(),draw(a.left,a.top)),window.requestAnimationFrame(render)}!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var $canvas=$("canvas"),canvas=$canvas[0],ctx=canvas.getContext("2d"),last={x:null,y:null},linecolor=$('input[type="color"]').val(),rods=".a, .b, .c",animVals=$(".a").css("animation").split(" "),paused=!1;setupCanvas(),$(window).resize(setupCanvas),window.requestAnimationFrame(render),$(".clear").click(clearScreen),$(".save").click(function(){window.open(canvas.toDataURL(),"_blank")}),$(".pause").click(function(){var a=$(this),b=(a.text(),$(rods).css("animation-play-state"));"paused"===b?(playAnim(),a.text("pause")):(pauseAnim(),a.text("run"))}),$(".controls").draggable({addClasses:!1,snap:"body"}),$spinners=$(".spinner").spinner(),$("#rodOpacitySlider").slider({value:99,orientation:"vertical"}).on("slide slidechange",function(){$(".a").css({opacity:$(this).slider("value")/100})}),$('input[type="color"]').on("change",function(){linecolor=$(this).val()}),$spinners.on("spinstop",function(){var a=$(this),b=a.val(),c=a.attr("id")[5];changeAnimTime(c,b)});